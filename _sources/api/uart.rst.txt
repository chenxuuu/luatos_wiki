uart - 串口操作库
=================

uart.setup(id, baud_rate, data_bits, stop_bits, partiy, bit_order, buff_size)
-----------------------------------------------------------------------------

配置串口参数

**参数**

========== =========================================
传入值类型 解释
========== =========================================
int        串口id, uart0写0, uart1写1
int        波特率 9600~115200
int        数据位 7或8, 一般是8
int        停止位 1或0, 一般是1
int        校验位, 可选 uart.None/uart.Even/uart.Odd
int        大小端, 默认小端 uart.LSB, 可选 uart.MSB
int        缓冲区大小, 默认值1024
========== =========================================

**返回值**

========== ========================
返回值类型 解释
========== ========================
int        成功返回0,失败返回其他值
========== ========================

**例子**

.. code:: lua

   -- 最常用115200 8N1
   uart.setup(1, 115200, 8, 1, uart.NONE)
   -- 可以简写为 uart.setup(1)

--------------

uart.write(id, data)
--------------------

写串口

**参数**

========== ==========================
传入值类型 解释
========== ==========================
int        串口id, uart0写0, uart1写1
string     待写入的数据
========== ==========================

**返回值**

========== ==============
返回值类型 解释
========== ==============
int        成功的数据长度
========== ==============

**例子**

.. code:: lua

   uart.write(1, "rdy\r\n")

--------------

uart.read(id, len)
------------------

读串口

**参数**

========== ==========================
传入值类型 解释
========== ==========================
int        串口id, uart0写0, uart1写1
int        读取长度
int        文件句柄(可选)
========== ==========================

**返回值**

========== ============
返回值类型 解释
========== ============
string     读取到的数据
========== ============

**例子**

.. code:: lua

   uart.read(1, 16)

--------------

uart.close(id)
--------------

关闭串口

**参数**

========== ==========================
传入值类型 解释
========== ==========================
int        串口id, uart0写0, uart1写1
========== ==========================

**返回值**

========== ========
返回值类型 解释
========== ========
nil        无返回值
========== ========

**例子**

.. code:: lua

   uart.close(1)

--------------

uart.on(id, event, func)
------------------------

注册串口事件回调

**参数**

========== ==========================
传入值类型 解释
========== ==========================
int        串口id, uart0写0, uart1写1
string     事件名称
function   回调方法
========== ==========================

**返回值**

========== ========
返回值类型 解释
========== ========
nil        无返回值
========== ========

**例子**

.. code:: lua

   uart.on("receive", function(id, len)
       local data = uart.read(id, len)
       log.info("uart", id, len, data)
   end)

--------------
